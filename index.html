<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Machine Learning: Course Project</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Machine Learning: Course Project</h1>

<h4>Executive Summary</h4>

<p>With the advent of personal tracking devices, such as Jawbone, Fitbit, and Nike FuelBand, it is possible to collect a huge amount of data on personal activity performance. The following project will analyze data collected from the accelerometers on the belt, forearm, arm, and dumbell of six participants from a weight lifting study. The participants were asked to perform barbell lifts correctly and incorrectly in five different ways. For detailed information about the study, you should see the “Weight Lifting Exercises Dataset” section at the following website:
<a href="http://groupware.les.inf.puc-rio.br/har">http://groupware.les.inf.puc-rio.br/har</a></p>

<p>The goal for this project is to predict the manner in which the participants did the exercise. The project will predict the “classe” variable found in the pmltrain set. The prediction model created during the execerise will be used to predict twenty different test cases in the pmltest dataset.</p>

<h4>Data Processing and Analysis</h4>

<p>The pml-training and pml-testing datasets URL&#39;s follows:
Pml-Training dataset:
<a href="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv">https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv</a>
Pml-Testing dataset:
<a href="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv">https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv</a></p>

<p>First, the required libraries will be loaded into R. </p>

<pre><code class="r">library(&quot;caret&quot;)
library(&quot;rpart&quot;)
library(&quot;foreach&quot;)
library(&quot;randomForest&quot;)
</code></pre>

<p>Next, the train and test datasets will be loaded into R.  In addition, the blank values in the dataset will be replaced with NA values for easier processing of the datasets.</p>

<pre><code class="r">training.url  &lt;- &#39;https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv&#39;
test.url      &lt;- &#39;https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv&#39;
download.file(training.url,&quot;pml-training.csv&quot;, method =&#39;curl&#39;)
download.file(test.url,&quot;pml-testing.csv&quot;, method =&#39;curl&#39;)
pmltrain &lt;- read.csv(&quot;pml-training.csv&quot;, header = TRUE, na.strings = c(&quot;NA&quot;, &quot;&quot;))
pmltest &lt;- read.csv(&quot;pml-testing.csv&quot;, header = TRUE, na.strings = c(&quot;NA&quot;, &quot;&quot;))
</code></pre>

<p>Next, we will find the columns that do not have a full set of values and will remove those columns from the test and train dataset.  As a result, the datasets will have 60 columns in the data.</p>

<pre><code class="r">pmltest &lt;- pmltest[, (colSums(is.na(pmltrain)) == 0)]
pmltrain &lt;- pmltrain[, (colSums(is.na(pmltrain)) == 0)]
</code></pre>

<p>The first six columns will be removed as the data in the columns do not add anything to the analysis of thw weight training data.</p>

<pre><code class="r">pmltrain &lt;- pmltrain[,-c(1:6)]
pmltest &lt;- pmltest[,-c(1:6)]
</code></pre>

<p>The train dataset will be split into a training dataset (70% of the observations) and a testing dataset (30% of the observations). The splitting of the dataset is for cross validation purposes. We will use the set.seed function so that the train dataset will be split in the same matter if this model is reproduced at a later date.</p>

<pre><code class="r">set.seed(22541)
inTrain = createDataPartition(y = pmltrain$classe, p = 0.7, list = FALSE)
training &lt;- pmltrain[inTrain, ]
testing &lt;- pmltrain[-inTrain, ]
</code></pre>

<h4>Principal Component Analysis</h4>

<p>The data next will undergo pre-processing using a principal component analysis. The last column (&#39;classe&#39;) will be removed from pre-processing. Next, the &#39;predict&#39; function will be applied to the pre-processed datasets.</p>

<pre><code class="r">preProc &lt;- preProcess(training[, -54], method = &quot;pca&quot;, thresh = 0.9)
trainPC &lt;- predict(preProc, training[, -54])
testPC &lt;- predict(preProc, testing[, -54])
</code></pre>

<p>Next, the train function in the caret package will be used to develop a model using the random forest method on the training dataset. Random forest is the best regression model to use as the rpart(regression trees) model results in a 36.36% accuracy rate (see appendix A).  In addition, the cross validation method when applying the random forest routine in the &#39;trainControl()&#39; parameter.  Also, without cross validation, the bootstrapping method takes a significantly longer and uses more computer memory.  Finally, the cross validation produces the same level of &#39;accuracy&#39; as the bootstrapping method.</p>

<pre><code class="r">modelFit &lt;- train(training$classe ~ ., method = &quot;rf&quot;, data = trainPC, trControl = trainControl(method = &quot;cv&quot;, number = 4))
</code></pre>

<p>We now review the relative importance of the resulting principal components of the trained model, &#39;modelFit&#39;.</p>

<pre><code class="r">varImp(modelFit$finalModel, scale = TRUE)
</code></pre>

<pre><code>##       Overall
## PC1  652.6111
## PC2  571.3095
## PC3  637.5960
## PC4  494.8789
## PC5  636.4057
## PC6  570.2243
## PC7  509.5920
## PC8  733.6072
## PC9  620.1485
## PC10 528.1678
## PC11 441.3380
## PC12 639.4514
## PC13 670.4694
## PC14 517.4454
## PC15 673.1057
## PC16 539.3864
## PC17 502.3959
## PC18 512.6739
## PC19 408.9359
</code></pre>

<p>As you look from the top to the bottom on the y-axis, this plot shows each of the principal components in order from most important to least important. The degree of importance is shown on the x-axis–increasing from left to right. Therefore, points high and to the right on this graph correspond to those principal components that are especially valuable in terms of being able to classify the observed training data.</p>

<h4>Cross Validation Testing</h4>

<p>The &#39;predict&#39; function will be called again so that the trained model is applied to the cross validated test dataset. The results can be viewed in the &#39;confusionMatrix&#39; function&#39;s output to see if the model is successful in predicting the values in the validation test set.</p>

<pre><code class="r">predicttest &lt;- predict(modelFit, testPC)
confusion &lt;- confusionMatrix(testing$classe, predicttest)
confusion
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1660    8    5    1    0
##          B   19 1100   17    2    1
##          C    4   11 1008    3    0
##          D    4    4   47  907    2
##          E    1    5    2    3 1071
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9764          
##                  95% CI : (0.9722, 0.9801)
##     No Information Rate : 0.2868          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.9701          
##  Mcnemar&#39;s Test P-Value : 7.667e-08       
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9834   0.9752   0.9342   0.9902   0.9972
## Specificity            0.9967   0.9918   0.9963   0.9885   0.9977
## Pos Pred Value         0.9916   0.9658   0.9825   0.9409   0.9898
## Neg Pred Value         0.9934   0.9941   0.9854   0.9982   0.9994
## Prevalence             0.2868   0.1917   0.1833   0.1556   0.1825
## Detection Rate         0.2821   0.1869   0.1713   0.1541   0.1820
## Detection Prevalence   0.2845   0.1935   0.1743   0.1638   0.1839
## Balanced Accuracy      0.9900   0.9835   0.9652   0.9894   0.9975
</code></pre>

<p>The estimated out-of-sample error is 1.000 minus the accuracy of the model. The accuracy is listed in the confusionmatrix  above.  The accuracy is also listed in the caret package postResample function.</p>

<pre><code class="r">accur &lt;- postResample(testing$classe, predicttest)
model_accuracy &lt;- accur[[1]]
model_accuracy
</code></pre>

<pre><code>## [1] 0.9763806
</code></pre>

<pre><code class="r">out_of_sample_error &lt;- 1 - model_accuracy
out_of_sample_error
</code></pre>

<pre><code>## [1] 0.02361937
</code></pre>

<p>The estimated accuracy of the model is 97.6% and the estimated out-of-sample error based on our fitted model applied to the cross validation dataset is 2.4%.</p>

<h4>Predicted Results</h4>

<p>Next, apply the pre-processing to the pmltrain dataset, after removing &#39;problem_id&#39; column from the dataset. Finally,the predict function is called to prdict the model against pmltest dataset.  Asthe last set the prediction results is displayed and this set will be uploaded in the twenty course submission website to compared the predicted results against the corrected results. </p>

<pre><code class="r">pmltest_pred &lt;- predict(preProc, pmltest[, -54])
pred_final &lt;- predict(modelFit, pmltest_pred)
</code></pre>

<h4>Appendix A</h4>

<p>Create a prediction model for the weight training dataset with the rpart(regression trees) model.</p>

<pre><code class="r">modelFit_rpart &lt;- train(training$classe ~ ., method = &quot;rpart&quot;, data = trainPC, trControl = trainControl(method = &quot;cv&quot;, number = 4))
</code></pre>

<p>Relative importance of the resulting principal components of the trained rpart model.</p>

<pre><code class="r">varImp(modelFit_rpart$finalModel, scale = TRUE)
</code></pre>

<pre><code>##        Overall
## PC1  246.04308
## PC13 422.16327
## PC15 347.82413
## PC18  95.79285
## PC3  305.18931
## PC5   97.68412
## PC8  381.26738
## PC2    0.00000
## PC4    0.00000
## PC6    0.00000
## PC7    0.00000
## PC9    0.00000
## PC10   0.00000
## PC11   0.00000
## PC12   0.00000
## PC14   0.00000
## PC16   0.00000
## PC17   0.00000
## PC19   0.00000
</code></pre>

<p>Predict classe data for the testing dataset with the rpart prediction model.</p>

<pre><code class="r">predicttest_rpart &lt;- predict(modelFit_rpart, testPC)
confusion_rpart &lt;- confusionMatrix(testing$classe, predicttest_rpart)
</code></pre>

<p>Confusion Matrix for rpart</p>

<pre><code class="r">confusion_rpart
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1300  240    0    0  134
##          B  572  494    0    0   73
##          C  689  256    0    0   81
##          D  459  271    0    0  234
##          E  506  230    0    0  346
## 
## Overall Statistics
##                                           
##                Accuracy : 0.3636          
##                  95% CI : (0.3513, 0.3761)
##     No Information Rate : 0.5992          
##     P-Value [Acc &gt; NIR] : 1               
##                                           
##                   Kappa : 0.1554          
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.3687  0.33132       NA       NA  0.39862
## Specificity            0.8415  0.85321   0.8257   0.8362  0.85330
## Pos Pred Value         0.7766  0.43371       NA       NA  0.31978
## Neg Pred Value         0.4714  0.78993       NA       NA  0.89132
## Prevalence             0.5992  0.25336   0.0000   0.0000  0.14749
## Detection Rate         0.2209  0.08394   0.0000   0.0000  0.05879
## Detection Prevalence   0.2845  0.19354   0.1743   0.1638  0.18386
## Balanced Accuracy      0.6051  0.59227       NA       NA  0.62596
</code></pre>

<p>Accuracy and out of sample error for rpart model.</p>

<pre><code class="r">accur_rpart &lt;- postResample(testing$classe, predicttest_rpart)
model_accuracy_rpart &lt;- accur_rpart[[1]]
model_accuracy_rpart
</code></pre>

<pre><code>## [1] 0.3636364
</code></pre>

<pre><code class="r">out_of_sample_error_rpart &lt;- 1 - model_accuracy_rpart
out_of_sample_error_rpart
</code></pre>

<pre><code>## [1] 0.6363636
</code></pre>

</body>

</html>
